2025-06-26 15:43:00,031 - INFO - Output folders created: ['outputs/tat_results', 'outputs/delay_results', 'outputs/excel_exports', 'outputs/csv_files', 'outputs/logs']
2025-06-26 15:43:00,032 - INFO - Setting up TAT calculation environment...
2025-06-26 15:43:00,032 - INFO - Loading Excel file: ts_big.xlsx
2025-06-26 15:43:01,067 - INFO - Loaded 5 rows and 39 columns
2025-06-26 15:43:01,068 - INFO - Converted po_created_date: datetime64[ns] -> datetime, 0/5 missing (0.0%)
2025-06-26 15:43:01,068 - INFO - Converted po_approval_date: datetime64[ns] -> datetime, 0/5 missing (0.0%)
2025-06-26 15:43:01,068 - INFO - Converted supplier_confirmation_date: datetime64[ns] -> datetime, 2/5 missing (40.0%)
2025-06-26 15:43:01,069 - INFO - Converted pi_invoice_approval_date: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 15:43:01,069 - INFO - Converted pi_payment_date: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 15:43:01,069 - INFO - Converted receive_first_prd_date: datetime64[ns] -> datetime, 2/5 missing (40.0%)
2025-06-26 15:43:01,070 - INFO - Converted prd_reconfirmed_date: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 15:43:01,070 - INFO - Converted po_im_date_value: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 15:43:01,070 - INFO - Converted po_sm_date_value: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 15:43:01,070 - INFO - Converted batch_created_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 15:43:01,071 - INFO - Converted sm_signoff_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 15:43:01,071 - INFO - Converted ci_invoice_approval_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,071 - INFO - Converted ci_payment_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,072 - INFO - Converted qc_schedule_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,072 - INFO - Converted ffw_booking_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 15:43:01,072 - INFO - Converted spd_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 15:43:01,073 - INFO - Converted stock_pickup_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,073 - INFO - Converted shipment_creation_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,074 - INFO - Converted shipment_in_transit_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,074 - INFO - Converted bi_invoice_approval_date: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 15:43:01,074 - INFO - Converted bi_payment_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,075 - INFO - Converted ffwp_telex_release_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,075 - INFO - Converted shipment_stock_delivery_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,075 - INFO - Converted item_receipt_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,076 - INFO - Converted actual_cargo_pick_up_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,076 - INFO - Converted actual_shipping_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,076 - INFO - Converted actual_arrival_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,076 - INFO - Converted actual_delivery_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 15:43:01,076 - INFO - All required columns present
2025-06-26 15:43:01,076 - INFO - Initializing TAT Calculator with config: stages_config.json
2025-06-26 15:43:01,520 - INFO - TAT Calculator initialized with 31 stages
2025-06-26 15:43:01,520 - INFO - TAT Calculator initialized successfully
2025-06-26 15:43:01,520 - INFO - Setup completed successfully!
2025-06-26 15:43:01,522 - INFO - Processing sample of 5 POs
2025-06-26 15:43:01,523 - INFO - Processing PO 1/5: PO373283MOUN-0000071
2025-06-26 15:43:01,524 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 15:43:01,533 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 15:43:01,534 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 15:43:01,534 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 15:43:01,540 - INFO - Processing PO 2/5: PO373323PXIN-0001031
2025-06-26 15:43:01,540 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 15:43:01,541 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-26 15:43:01,544 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-26 15:43:01,545 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-26 15:43:01,545 - INFO - Processing PO 3/5: PO373366ROOM-0337551
2025-06-26 15:43:01,546 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 15:43:01,546 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-26 15:43:01,549 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-26 15:43:01,550 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-26 15:43:01,550 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-26 15:43:01,550 - INFO - Processing PO 4/5: PO373771AMAZ-0002481
2025-06-26 15:43:01,550 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 15:43:01,550 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-26 15:43:01,553 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-26 15:43:01,554 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-26 15:43:01,554 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-26 15:43:01,554 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-26 15:43:01,554 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-26 15:43:01,554 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-26 15:43:01,554 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-26 15:43:01,554 - INFO - Processing PO 5/5: PO373857M2B3-10030650
2025-06-26 15:43:01,554 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 15:43:01,557 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 15:43:01,557 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 15:43:01,557 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 15:43:01,557 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 15:43:01,558 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 15:43:01,558 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 15:43:01,561 - INFO - Completed calculations: 5 successful, 0 errors
2025-06-26 15:43:01,565 - INFO - TAT results saved to: outputs/tat_results/tat_results_20250626_154301.json
2025-06-26 15:43:01,567 - INFO - Delay results saved to: outputs/delay_results/delay_results_20250626_154301.json
2025-06-26 15:43:01,574 - INFO - Processed CSV saved to: outputs/csv_files/processed_data_20250626_154301.csv
2025-06-26 15:43:01,636 - INFO - Results exported to: outputs/excel_exports/tat_export_20250626_154301.xlsx
2025-06-26 15:43:01,674 - INFO - Delay report exported to: outputs/excel_exports/delay_report_20250626_154301.xlsx
2025-06-26 16:05:45,236 - INFO - Output folders created: ['outputs/tat_results', 'outputs/delay_results', 'outputs/excel_exports', 'outputs/csv_files', 'outputs/logs']
2025-06-26 16:05:45,236 - INFO - Setting up TAT calculation environment...
2025-06-26 16:05:45,236 - INFO - Loading Excel file: ts_big.xlsx
2025-06-26 16:05:46,020 - INFO - Loaded 5 rows and 39 columns
2025-06-26 16:05:46,021 - INFO - Converted po_created_date: datetime64[ns] -> datetime, 0/5 missing (0.0%)
2025-06-26 16:05:46,021 - INFO - Converted po_approval_date: datetime64[ns] -> datetime, 0/5 missing (0.0%)
2025-06-26 16:05:46,022 - INFO - Converted supplier_confirmation_date: datetime64[ns] -> datetime, 2/5 missing (40.0%)
2025-06-26 16:05:46,022 - INFO - Converted pi_invoice_approval_date: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:05:46,022 - INFO - Converted pi_payment_date: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:05:46,022 - INFO - Converted receive_first_prd_date: datetime64[ns] -> datetime, 2/5 missing (40.0%)
2025-06-26 16:05:46,023 - INFO - Converted prd_reconfirmed_date: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 16:05:46,023 - INFO - Converted po_im_date_value: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 16:05:46,023 - INFO - Converted po_sm_date_value: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 16:05:46,023 - INFO - Converted batch_created_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:05:46,024 - INFO - Converted sm_signoff_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:05:46,024 - INFO - Converted ci_invoice_approval_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,024 - INFO - Converted ci_payment_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,025 - INFO - Converted qc_schedule_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,025 - INFO - Converted ffw_booking_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:05:46,025 - INFO - Converted spd_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:05:46,026 - INFO - Converted stock_pickup_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,026 - INFO - Converted shipment_creation_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,026 - INFO - Converted shipment_in_transit_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,027 - INFO - Converted bi_invoice_approval_date: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 16:05:46,027 - INFO - Converted bi_payment_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,027 - INFO - Converted ffwp_telex_release_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,028 - INFO - Converted shipment_stock_delivery_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,028 - INFO - Converted item_receipt_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,028 - INFO - Converted actual_cargo_pick_up_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,029 - INFO - Converted actual_shipping_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,029 - INFO - Converted actual_arrival_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,029 - INFO - Converted actual_delivery_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:05:46,029 - INFO - All required columns present
2025-06-26 16:05:46,029 - INFO - Initializing TAT Calculator with config: stages_config.json
2025-06-26 16:05:46,482 - INFO - TAT Calculator initialized with 31 stages
2025-06-26 16:05:46,482 - INFO - TAT Calculator initialized successfully
2025-06-26 16:05:46,482 - INFO - Setup completed successfully!
2025-06-26 16:05:46,483 - INFO - Processing sample of 5 POs
2025-06-26 16:05:46,483 - INFO - Using integrated delay calculation...
2025-06-26 16:05:46,492 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:05:46,502 - INFO - Processed PO: PO373283MOUN-0000071
2025-06-26 16:05:46,506 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:05:46,507 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-26 16:05:46,507 - INFO - Processed PO: PO373323PXIN-0001031
2025-06-26 16:05:46,511 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:05:46,512 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-26 16:05:46,512 - INFO - Processed PO: PO373366ROOM-0337551
2025-06-26 16:05:46,516 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:05:46,516 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-26 16:05:46,517 - INFO - Processed PO: PO373771AMAZ-0002481
2025-06-26 16:05:46,520 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:05:46,525 - INFO - Processed PO: PO373857M2B3-10030650
2025-06-26 16:05:46,527 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:05:46,528 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:05:46,528 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:05:46,533 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-26 16:05:46,534 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-26 16:05:46,536 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-26 16:05:46,538 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:05:46,538 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 16:05:46,538 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 16:05:46,538 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 16:05:46,538 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-26 16:05:46,538 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:05:46,538 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:05:46,538 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-26 16:05:46,538 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-26 16:05:46,539 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-26 16:05:46,541 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:05:46,541 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 16:05:46,541 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 16:05:46,541 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 16:05:46,541 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:05:46,541 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:05:46,544 - INFO - Completed calculations with integrated delays: 5 TAT results, 5 delay analyses
2025-06-26 16:05:46,548 - INFO - TAT results with delays saved to: outputs/tat_results/tat_results_with_delays_20250626_160546.json
2025-06-26 16:05:46,550 - INFO - Detailed delay results saved to: outputs/delay_results/detailed_delay_analysis_20250626_160546.json
2025-06-26 16:05:46,559 - INFO - Processed CSV saved to: outputs/csv_files/processed_data_20250626_160546.csv
2025-06-26 16:05:46,660 - INFO - Results exported to: outputs/excel_exports/tat_export_with_delays_20250626_160546.xlsx
2025-06-26 16:05:46,704 - INFO - Delay report exported to: outputs/excel_exports/detailed_delay_report_20250626_160546.xlsx
2025-06-26 16:42:53,006 - INFO - Output folders created: ['outputs/tat_results', 'outputs/delay_results', 'outputs/excel_exports', 'outputs/csv_files', 'outputs/logs']
2025-06-26 16:42:53,006 - INFO - Setting up TAT calculation environment...
2025-06-26 16:42:53,006 - INFO - Loading Excel file: ts_big.xlsx
2025-06-26 16:42:53,686 - INFO - Loaded 5 rows and 39 columns
2025-06-26 16:42:53,687 - INFO - Converted po_created_date: datetime64[ns] -> datetime, 0/5 missing (0.0%)
2025-06-26 16:42:53,687 - INFO - Converted po_approval_date: datetime64[ns] -> datetime, 0/5 missing (0.0%)
2025-06-26 16:42:53,688 - INFO - Converted supplier_confirmation_date: datetime64[ns] -> datetime, 2/5 missing (40.0%)
2025-06-26 16:42:53,688 - INFO - Converted pi_invoice_approval_date: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:42:53,688 - INFO - Converted pi_payment_date: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:42:53,689 - INFO - Converted receive_first_prd_date: datetime64[ns] -> datetime, 2/5 missing (40.0%)
2025-06-26 16:42:53,689 - INFO - Converted prd_reconfirmed_date: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 16:42:53,689 - INFO - Converted po_im_date_value: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 16:42:53,689 - INFO - Converted po_sm_date_value: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 16:42:53,690 - INFO - Converted batch_created_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:42:53,690 - INFO - Converted sm_signoff_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:42:53,690 - INFO - Converted ci_invoice_approval_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,691 - INFO - Converted ci_payment_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,691 - INFO - Converted qc_schedule_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,691 - INFO - Converted ffw_booking_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:42:53,692 - INFO - Converted spd_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-26 16:42:53,692 - INFO - Converted stock_pickup_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,692 - INFO - Converted shipment_creation_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,692 - INFO - Converted shipment_in_transit_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,693 - INFO - Converted bi_invoice_approval_date: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-26 16:42:53,693 - INFO - Converted bi_payment_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,693 - INFO - Converted ffwp_telex_release_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,694 - INFO - Converted shipment_stock_delivery_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,694 - INFO - Converted item_receipt_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,694 - INFO - Converted actual_cargo_pick_up_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,694 - INFO - Converted actual_shipping_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,695 - INFO - Converted actual_arrival_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,695 - INFO - Converted actual_delivery_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-26 16:42:53,695 - INFO - All required columns present
2025-06-26 16:42:53,695 - INFO - Initializing TAT Calculator with config: stages_config.json
2025-06-26 16:42:54,136 - INFO - TAT Calculator initialized with 31 stages
2025-06-26 16:42:54,136 - INFO - TAT Calculator initialized successfully
2025-06-26 16:42:54,136 - INFO - Setup completed successfully!
2025-06-26 16:42:54,137 - INFO - Processing sample of 5 POs
2025-06-26 16:42:54,137 - INFO - Using integrated delay calculation...
2025-06-26 16:42:54,145 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:42:54,154 - INFO - Processed PO: PO373283MOUN-0000071
2025-06-26 16:42:54,157 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:42:54,157 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-26 16:42:54,159 - INFO - Processed PO: PO373323PXIN-0001031
2025-06-26 16:42:54,162 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:42:54,162 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-26 16:42:54,163 - INFO - Processed PO: PO373366ROOM-0337551
2025-06-26 16:42:54,166 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:42:54,166 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-26 16:42:54,167 - INFO - Processed PO: PO373771AMAZ-0002481
2025-06-26 16:42:54,169 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-26 16:42:54,175 - INFO - Processed PO: PO373857M2B3-10030650
2025-06-26 16:42:54,177 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:42:54,178 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:42:54,178 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-26 16:42:54,183 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-26 16:42:54,184 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-26 16:42:54,184 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-26 16:42:54,184 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-26 16:42:54,184 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-26 16:42:54,184 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-26 16:42:54,184 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-26 16:42:54,186 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-26 16:42:54,188 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-26 16:42:54,190 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-26 16:42:54,190 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-26 16:42:54,190 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-26 16:42:54,190 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-26 16:42:54,191 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-26 16:42:54,191 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-26 16:42:54,194 - INFO - Completed calculations with integrated delays: 5 TAT results, 5 delay analyses
2025-06-26 16:42:54,197 - INFO - TAT results with delays saved to: outputs/tat_results/tat_results_with_delays_20250626_164254.json
2025-06-26 16:42:54,199 - INFO - Detailed delay results saved to: outputs/delay_results/detailed_delay_analysis_20250626_164254.json
2025-06-26 16:42:54,204 - INFO - Processed CSV saved to: outputs/csv_files/processed_data_20250626_164254.csv
2025-06-26 16:42:54,293 - INFO - Results exported to: outputs/excel_exports/tat_export_with_delays_20250626_164254.xlsx
2025-06-26 16:42:54,344 - INFO - Stage-level results exported to: outputs/excel_exports/stage_level_analysis_20250626_164254.xlsx
2025-06-26 16:42:54,344 - INFO -   - actual_timestamps tab: 5 POs x 31 stages
2025-06-26 16:42:54,344 - INFO -   - timestamps tab: 5 POs x 31 stages
2025-06-26 16:42:54,344 - INFO -   - delay_days tab: 5 POs x 31 stages
2025-06-26 16:42:54,380 - INFO - Delay report exported to: outputs/excel_exports/detailed_delay_report_20250626_164254.xlsx
2025-06-30 19:53:41,979 - INFO - Output folders created: ['outputs/tat_results', 'outputs/delay_results', 'outputs/excel_exports', 'outputs/csv_files', 'outputs/logs']
2025-06-30 19:53:41,980 - INFO - Setting up TAT calculation environment...
2025-06-30 19:53:41,981 - INFO - Loading Excel file: ts_big.xlsx
2025-06-30 19:53:43,344 - INFO - Loaded 5 rows and 39 columns
2025-06-30 19:53:43,349 - INFO - Converted po_created_date: datetime64[ns] -> datetime, 0/5 missing (0.0%)
2025-06-30 19:53:43,351 - INFO - Converted po_approval_date: datetime64[ns] -> datetime, 0/5 missing (0.0%)
2025-06-30 19:53:43,355 - INFO - Converted supplier_confirmation_date: datetime64[ns] -> datetime, 2/5 missing (40.0%)
2025-06-30 19:53:43,357 - INFO - Converted pi_invoice_approval_date: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-30 19:53:43,362 - INFO - Converted pi_payment_date: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-30 19:53:43,367 - INFO - Converted receive_first_prd_date: datetime64[ns] -> datetime, 2/5 missing (40.0%)
2025-06-30 19:53:43,369 - INFO - Converted prd_reconfirmed_date: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-30 19:53:43,371 - INFO - Converted po_im_date_value: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-30 19:53:43,374 - INFO - Converted po_sm_date_value: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-30 19:53:43,375 - INFO - Converted batch_created_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-30 19:53:43,377 - INFO - Converted sm_signoff_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-30 19:53:43,384 - INFO - Converted ci_invoice_approval_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,387 - INFO - Converted ci_payment_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,393 - INFO - Converted qc_schedule_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,403 - INFO - Converted ffw_booking_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-30 19:53:43,405 - INFO - Converted spd_ts: datetime64[ns] -> datetime, 3/5 missing (60.0%)
2025-06-30 19:53:43,408 - INFO - Converted stock_pickup_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,410 - INFO - Converted shipment_creation_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,413 - INFO - Converted shipment_in_transit_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,416 - INFO - Converted bi_invoice_approval_date: datetime64[ns] -> datetime, 4/5 missing (80.0%)
2025-06-30 19:53:43,418 - INFO - Converted bi_payment_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,420 - INFO - Converted ffwp_telex_release_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,422 - INFO - Converted shipment_stock_delivery_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,424 - INFO - Converted item_receipt_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,426 - INFO - Converted actual_cargo_pick_up_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,428 - INFO - Converted actual_shipping_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,432 - INFO - Converted actual_arrival_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,435 - INFO - Converted actual_delivery_date: float64 -> datetime, 5/5 missing (100.0%)
2025-06-30 19:53:43,435 - INFO - All required columns present
2025-06-30 19:53:43,436 - INFO - Initializing TAT Calculator with config: stages_config.json
2025-06-30 19:53:45,393 - INFO - TAT Calculator initialized with 31 stages
2025-06-30 19:53:45,395 - INFO - TAT Calculator initialized successfully
2025-06-30 19:53:45,395 - INFO - Setup completed successfully!
2025-06-30 19:53:45,397 - INFO - Processing sample of 5 POs
2025-06-30 19:53:45,397 - INFO - Using integrated delay calculation...
2025-06-30 19:53:45,431 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-30 19:53:45,465 - INFO - Processed PO: PO373283MOUN-0000071
2025-06-30 19:53:45,490 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-30 19:53:45,516 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-30 19:53:45,570 - INFO - Processed PO: PO373323PXIN-0001031
2025-06-30 19:53:45,584 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-30 19:53:45,596 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-30 19:53:45,606 - INFO - Processed PO: PO373366ROOM-0337551
2025-06-30 19:53:45,626 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-30 19:53:45,631 - ERROR - Error evaluating expression '': invalid syntax (<unknown>, line 0)
2025-06-30 19:53:45,635 - INFO - Processed PO: PO373771AMAZ-0002481
2025-06-30 19:53:45,657 - ERROR - Error evaluating expression 'max(prd_reconfirmed_date, add_days(receive_first_prd_date, plt -21),stage_8+plt-21)': cannot convert float NaN to integer
2025-06-30 19:53:45,700 - INFO - Processed PO: PO373857M2B3-10030650
2025-06-30 19:53:45,717 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-30 19:53:45,722 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-30 19:53:45,723 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-30 19:53:45,756 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-30 19:53:45,756 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-30 19:53:45,757 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-30 19:53:45,758 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-30 19:53:45,758 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-30 19:53:45,759 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-30 19:53:45,760 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-30 19:53:45,760 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-30 19:53:45,761 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-30 19:53:45,761 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-30 19:53:45,764 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-30 19:53:45,765 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-30 19:53:45,766 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-30 19:53:45,766 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-30 19:53:45,767 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-30 19:53:45,768 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-30 19:53:45,769 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-30 19:53:45,769 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-30 19:53:45,771 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-30 19:53:45,771 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-30 19:53:45,772 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-30 19:53:45,772 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-30 19:53:45,790 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-30 19:53:45,791 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-30 19:53:45,792 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-30 19:53:45,793 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-30 19:53:45,795 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-30 19:53:45,796 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-30 19:53:45,797 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-30 19:53:45,797 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-30 19:53:45,798 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-30 19:53:45,800 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-30 19:53:45,801 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-30 19:53:45,802 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-30 19:53:45,803 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-30 19:53:45,803 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-30 19:53:45,804 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-30 19:53:45,805 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-30 19:53:45,805 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-30 19:53:45,806 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-30 19:53:45,806 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-30 19:53:45,807 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-30 19:53:45,808 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-30 19:53:45,808 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-30 19:53:45,833 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-30 19:53:45,835 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-30 19:53:45,836 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-30 19:53:45,837 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-30 19:53:45,837 - WARNING - No valid target timestamp found in stage result: 14. SM Sign-Off Pending
2025-06-30 19:53:45,838 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-30 19:53:45,839 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-30 19:53:45,839 - WARNING - No valid target timestamp found in stage result: 17. QC Schedule Pending
2025-06-30 19:53:45,839 - WARNING - No valid target timestamp found in stage result: 18. FFW Booking Missing
2025-06-30 19:53:45,840 - WARNING - No valid target timestamp found in stage result: 19. Supplier Pickup Date Pending
2025-06-30 19:53:45,841 - WARNING - No valid target timestamp found in stage result: 20. Pre Pickup Check
2025-06-30 19:53:45,841 - WARNING - No valid target timestamp found in stage result: 21. FOB Pickup Pending
2025-06-30 19:53:45,842 - WARNING - No valid target timestamp found in stage result: 22. Non FOB Pickup Pending
2025-06-30 19:53:45,843 - WARNING - No valid target timestamp found in stage result: 23. INB Creation Pending
2025-06-30 19:53:45,843 - WARNING - No valid target timestamp found in stage result: 24. Mark In-Transit Pending
2025-06-30 19:53:45,844 - WARNING - No valid target timestamp found in stage result: 25. BL Approval Pending
2025-06-30 19:53:45,845 - WARNING - No valid target timestamp found in stage result: 26. BL Payment Pending - In Transit
2025-06-30 19:53:45,847 - WARNING - No valid target timestamp found in stage result: 27. BL Payment Pending - Arrived
2025-06-30 19:53:45,848 - WARNING - No valid target timestamp found in stage result: 28. Telex Release Pending
2025-06-30 19:53:45,848 - WARNING - No valid target timestamp found in stage result: 29. Stock Delivery Pending
2025-06-30 19:53:45,849 - WARNING - No valid target timestamp found in stage result: 30. Stock Receiving Pending
2025-06-30 19:53:45,850 - WARNING - No valid target timestamp found in stage result: 31. Dispute - PO Closing Pending
2025-06-30 19:53:45,870 - WARNING - No valid target timestamp found in stage result: 10. PRD Confirmation Pending
2025-06-30 19:53:45,871 - WARNING - No valid target timestamp found in stage result: 11. IM Sign-Off Pending
2025-06-30 19:53:45,872 - WARNING - No valid target timestamp found in stage result: 12. Ready for Batching Pending
2025-06-30 19:53:45,872 - WARNING - No valid target timestamp found in stage result: 13. Batch Creation Pending
2025-06-30 19:53:45,874 - WARNING - No valid target timestamp found in stage result: 15. CI Approval Pending
2025-06-30 19:53:45,874 - WARNING - No valid target timestamp found in stage result: 16. CI Payment Pending
2025-06-30 19:53:45,901 - INFO - Completed calculations with integrated delays: 5 TAT results, 5 delay analyses
2025-06-30 19:53:45,940 - INFO - TAT results with delays saved to: outputs/tat_results/tat_results_with_delays_20250630_195345.json
2025-06-30 19:53:45,956 - INFO - Detailed delay results saved to: outputs/delay_results/detailed_delay_analysis_20250630_195345.json
2025-06-30 19:53:45,973 - INFO - Processed CSV saved to: outputs/csv_files/processed_data_20250630_195345.csv
2025-06-30 19:53:46,676 - INFO - Results exported to: outputs/excel_exports/tat_export_with_delays_20250630_195345.xlsx
2025-06-30 19:53:46,943 - INFO - Stage-level results exported to: outputs/excel_exports/stage_level_analysis_20250630_195346.xlsx
2025-06-30 19:53:46,945 - INFO -   - actual_timestamps tab: 5 POs x 31 stages
2025-06-30 19:53:46,947 - INFO -   - timestamps tab: 5 POs x 31 stages
2025-06-30 19:53:46,948 - INFO -   - delay_days tab: 5 POs x 31 stages
2025-06-30 19:53:47,147 - INFO - Delay report exported to: outputs/excel_exports/detailed_delay_report_20250630_195346.xlsx
